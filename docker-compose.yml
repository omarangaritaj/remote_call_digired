version: '3.8'

services:
  gpio-controller:
    build: .
    container_name: raspberry-gpio-controller
    restart: always
    ports:
      - "8000:8000"
    environment:
      - API_URL=${API_URL}
      - API_KEY=${API_KEY}
      - API_TOKEN=${API_TOKEN}
      - DEVICE_ID=${DEVICE_ID:-raspberry-pi-001}
    privileged: true  # Necesario para acceso a GPIO
    volumes:
      - /sys:/sys
      - /dev:/dev
    devices:
      - /dev/gpiomem:/dev/gpiomem
      - /dev/mem:/dev/mem
    group_add:
      - gpio
    networks:
      - gpio-network

networks:
  gpio-network:
    driver: bridge